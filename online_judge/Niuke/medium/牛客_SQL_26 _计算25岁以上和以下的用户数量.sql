/ *

平台：牛客网
题号：SQL26
题目：计算25岁以上和以下的用户数量
难度：中等


题目要求:

将用户划分为两个年龄段：
25岁以下（包含NULL值）
25岁及以上（包含25岁）
统计每个年龄段的用户数量
特殊要求：题目明确说明age为null也计为25岁以下


解题思路：

1.条件分类需求：需要根据年龄值进行分类
2.处理NULL值：题目要求NULL按特定规则处理
3.结果分组：需要按分类结果进行分组统计

* /

-- ========== 我的解答 ==========
select
  case when age<25 or age is null then'25岁以下'
    else'25岁及以上'
    end as age_cut,
    count(*) as number
from 
  user_profile
group by
  age_cut;
/*
执行通过
提交时间：2026.1.27


关键学习点：

1.CASE WHEN 的核心用法:

  -条件判断：实现IF-ELSE逻辑，根据条件返回不同值
  -字段转换：将数值字段转换为更有业务意义的分类标签
  -NULL处理：通过OR age IS NULL显式处理空值情况

2.易错点：

  -边界值处理
  -null值处理

学习掌握：

理解CASE WHEN基本语法结构
能处理简单的条件分类
知道如何分组统计数量
了解NULL值的特殊处理