-- 商品销售分析
-- 1. 最畅销的商品（按销售额）
SELECT 
    product,
    category,
    SUM(quantity) AS 总销量,
    SUM(price * quantity) AS 总销售额
FROM ecommerce_orders
GROUP BY product, category
ORDER BY 总销售额 DESC
LIMIT 10;

-- 2. 各品类销售占比
SELECT 
    category,
    SUM(price * quantity) AS 品类销售额,
    ROUND(
        SUM(price * quantity) * 100.0 / 
        (SELECT SUM(price * quantity) FROM ecommerce_orders),
        2
    ) AS 销售额占比
FROM ecommerce_orders
GROUP BY category
ORDER BY 品类销售额 DESC;

-- 3. 高单价商品分析（价格>5000）
SELECT 
    product,
    price,
    COUNT(*) AS 购买次数
FROM ecommerce_orders
WHERE price > 5000
GROUP BY product, price
ORDER BY price DESC;